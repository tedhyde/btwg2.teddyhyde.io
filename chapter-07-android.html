<body>
<div id="excerpt"><div class="sect1">
<h2>Android and the Git Data API</h2>
<div class="sectionbody"><div class="paragraph"><p>
You might not use your phone right now as a developer tool, but the
odds are that you will soon. At the moment, phones and tablets can be
great for reading code, but the editors we developers use on our
laptops have not yet been reimagined for mobile devices. We are
getting close though: the GitHub API is accessible through the well
written EGit client library for Java, and this library supports both reading
data stored on GitHub and writing data back into it. These are a
perfect set of building blocks to develop applications for the Android
platform, currently the world’s most popular mobile OS.
</p></div></div>
</div></div>


<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Android and the Git Data API</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase-auth.js"></script>
<script src="https://cdn.teddyhyde.com/0.0.1/teddyhyde-client-0.0.1.js"></script>
<script src="edit.js"></script>
<link rel="stylesheet" type="text/css" href="fab.css">
<link rel="stylesheet" type="text/css" href="micromodal.css">
<link rel="stylesheet" type="text/css" href="https://cdn.teddyhyde.com/0.0.1/teddyhyde-reveal-jekyll.css">
<!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-1.8.2.min.js"></script>
<!-- Include jQuery Popup Overlay -->
<script src="https://cdn.rawgit.com/vast-engineering/jquery-popup-overlay/1.7.13/jquery.popupoverlay.js"></script>


<div id="header">
</div>
<div id="content" style="display: none">
<div class="sect1">
<h2 id="_android_and_the_git_data_api">Android and the Git Data API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You might not use your phone right now as a developer tool, but the
odds are that you will soon. At the moment, phones and tablets can be
great for reading code, but the editors we developers use on our
laptops have not yet been reimagined for mobile devices. We are
getting close though: the GitHub API is accessible through the well
written EGit client library for Java, and this library supports both reading
data stored on GitHub and writing data back into it. These are a
perfect set of building blocks to develop applications for the Android
platform, currently the world’s most popular mobile OS.</p>
</div>
<div class="paragraph">
<p>In this chapter, we’ll use the Java EGit libraries to develop a small
Android application which posts to our blog hosted on GitHub. Our
blogging application will allow us to login to GitHub, and then ask us
for a quick note describing how we are feeling. The application will
then compose a Jekyll blog post for us and push the post into our blog
on GitHub.</p>
</div>
<div class="sect2">
<h3 id="_setting_up">Setting Up</h3>
<div class="paragraph">
<p>To build this application, we need to create a Jekyll blog and then
install the necessary Android build tools.</p>
</div>
<div class="sect3">
<h4 id="_creating_a_jekyll_blog">Creating a Jekyll blog</h4>
<div class="paragraph">
<p>We are writing an application which adds jekyll blog entries, and we
are writing tests to verify our application works as advertisted, so
we need a sandbox blog against which we can run commands. There are
various ways to create a new Jekyll blog. The simplest is to run a
series of Ruby commands documented here; if you want to know more
about Jekyll, it is covered in more depth in the Jekyll chapter.
There are a few items of note when establishing a Jekyll blog that
have some complexity, things like mapping a hostname properly and using the
correct branch inside git. For our purposes here, however, we won’t need
to make sure all that is established. All we need is to make sure that
we have a sandbox repository that has the structure of a jekyll blog.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ printf "source 'https://rubygems.org'\n\ngem 'github-pages'\ngem 'hub'" &gt;&gt; Gemfile
$ export BLOG_NAME=mytestblog
$ bundle
$ jekyll new $BLOG_NAME
$ cd $BLOG_NAME
$ hub create
$ git push -u origin master</code></pre>
</div>
</div>
<div class="paragraph">
<p>These commands install the correct libraries for using Jekyll (and one
for our tests as well), generate a new blog using the jekyll command
line tool, and then create a blog on GitHub with those files. On the
second line we specify the name of the blog; you are welcome to change
this to any name you’d like, just make sure the tests match the name.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
When you have finished running these commands, you should close the
terminal window. There are other commands later in this chapter which
should occur in a fresh directory and as such it is best not to run
those commands from within the same directory where you created your
jekyll blog. You’ve pushed all those files into GitHub, so you could
safely delete the local repository in this directory.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_android_development_tools">Android Development Tools</h4>
<div class="paragraph">
<p>If you don’t have a physical Android device, don’t fret. You can follow
along with this chapter without having an actual Android device by doing
development and testing on a virtual device.</p>
</div>
<div class="sect4">
<h5 id="_installing_the_java_sdk">Installing the Java SDK</h5>
<div class="paragraph">
<p>Unfortunately there is no simple shell command to install Java in the
same way as there is for Ruby and NodeJS using RVM or NVM.
Oracle controls the Java language and distribution of official SDKs,
and they restrict access to downloads other than from java.oracle.com.
Java is freely available, but you need to visit java.oracle.com and
find the correct download for your needs. Android works with the 1.7
versions of Java or better.</p>
</div>
</div>
<div class="sect4">
<h5 id="_installing_android_studio">Installing Android Studio</h5>
<div class="paragraph">
<p>We will use Android Studio, the Google IDE for developing Android
applications. To install it, go to
<a href="https://developer.android.com/sdk/index.html" class="bare">https://developer.android.com/sdk/index.html</a> and you will see a
download button for your platform (OSX, Linux and Windows
supported). Android Studio bundles all the important tools for
building Android applications.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_new_project">Creating a New Project</h3>
<div class="paragraph">
<p>Let’s now create our Android project. When you first open Android
Studio, you will see an option in the right pane inviting you to
create a new project. Click on the "Start a new Android Studio
project" option. In the next step, you will see a screen for
configuring your new project. Enter in GhRU ("GitHub R U?") into the
Application Name and use <code>example.com</code> as the Company Domain (or use
your own domain, but be aware this will make the directory structure
presented in this chapter different than yours). Android Studio should
automatically generate the "package name" for you as
<code>com.example.ghru</code>.</p>
</div>
<div class="paragraph">
<p>You will then need to choose a target SDK. The higher the target,
the better access to newer Android APIs, but the fewer number of
devices which can run the application. The code in this chapter will
work with older SDKs, so let’s make a balanced choice and use Android
4.4 (KitKat) running on phone and tablets. At the moment this means,
according to Android Studio, that our application will run on 49.5% of
Android devices in the world.</p>
</div>
<div id="choose-android-sdk" class="imageblock">
<div class="content">
<img src="images/btwg_07in01.png" alt="Choose an Android SDK">
</div>
<div class="title">Figure 1. Choose an Android SDK</div>
</div>
<div class="paragraph">
<p>You will then be presented with a choice of activities. Choose "Blank
Activity". You will be taken to a screen which allows you to customize
the activity. Accept the defaults of "MainActivity" as the Activity
Name and the associated files for the layout, title and menu resource
name. Then click the "Finish" button to generate the project.</p>
</div>
<div class="paragraph">
<p>After completing these steps, Android Studio will create gradle
configuration files and generate the structure of your
application. Once this has completed, you can review the file tree of
your project by clicking on the left hand vertical tab labeled
"Project".</p>
</div>
<div id="reviewing-android-project-structure" class="imageblock">
<div class="content">
<img src="images/btwg_07in02.png" alt="Reviewing the Android project structure for the first time">
</div>
<div class="title">Figure 2. Reviewing the Android project structure for the first time]</div>
</div>
<div class="paragraph">
<p>If you have never seen an Android project before, this screen deserves
some explanation. The "app" directory contains your application code and
resources (layout files, images, and strings). Inside the "app"
directory you will see several other directories: The "java" directory
contains, quite obviously, any java code for the project, which
includes the application files, and also programs which do not reside
in the app when it is published to the app store but perform testing
on the app. The "res" directory contains the resources as we
mentioned. Android Studio lists all build files under the "Gradle
Scripts" section, and groups them regardless of their directory
placement. You can see two "build.gradle" files, the first of which
you can generally ignore, though the second we will need to adjust.</p>
</div>
<div class="paragraph">
<p>Now we are ready to start editing our project.</p>
</div>
<div class="sect3">
<h4 id="_editing_the_gradle_build_file">Editing the Gradle Build File</h4>
<div class="paragraph">
<p>First, we need to add to our Gradle build file and specify the
dependent libraries. Gradle is a build system for Java and has become
the offical build system for the Android platform. Open the
<code>build.gradle</code> within the <code>app</code> module (the second of the two
<code>build.gradle</code> files).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">apply plugin: 'com.android.application' //  <b class="conum">(1)</b>

android {
    compileSdkVersion 23 //  <b class="conum">(2)</b>
    buildToolsVersion "23.0.1"

    defaultConfig {
        applicationId "com.example.ghru"
        minSdkVersion 21
        targetSdkVersion 23
        versionCode 1
        versionName "1.0"
        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner" //  <b class="conum">(3)</b>
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}

dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar']) //  <b class="conum">(4)</b>
    compile 'com.android.support:appcompat-v7:23.0.1'
    compile 'org.eclipse.mylyn.github:org.eclipse.egit.github.core:2.1.5'
    compile( 'commons-codec:commons-codec:1.9' )
    testCompile 'junit:junit:4.12' //  <b class="conum">(5)</b>
    testCompile 'com.squareup.okhttp:okhttp:2.5.0'
    androidTestCompile 'com.android.support.test:runner:0.4' //  <b class="conum">(6)</b>
    androidTestCompile 'com.android.support.test:rules:0.4'
    androidTestCompile 'com.android.support.test.espresso:espresso-core:2.2.1'
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First, we load the Android gradle plugin. This extends our project
to allow an <code>android</code> block, which we specify next.</p>
</li>
<li>
<p>Next, we configure our Android block, with things like the target
version (which we choose when setting up our project) and the actual
SDK which we are using to compile the application.</p>
</li>
<li>
<p>In order to run UI tests, we need to specify a test runner
called the <code>AndroidJUnitRunner</code></p>
</li>
<li>
<p>Android Studio automatically adds a configuration to our build
file which loads any JARS (Java libraries) from the <code>lib</code>
directory. We also install the support compatibility library for older
Android devices, and most importantly, the EGit library which manages
connections to GitHub for us. The commons codec library from the
Apache Foundation proides tools that help to encode content into
Base64, one of the options for storing data inside a GitHub repository
using the API.</p>
</li>
<li>
<p>Next we install libraries which are only used when we run unit
tests. <code>testCompile</code> libraries are compiled only when the code is run
on the local development machine, and for this situation we need the
JUnit library, and the OkHttp library from Square which helps us
validate that our request for a new commit has made it all the way
into the GitHub API.</p>
</li>
<li>
<p>Lastly, we install the espresso libraries, the Google UI testing
framework. The first line (of the three libraries) installs the test
runner which we configured above. We use <code>androidTestCompile</code> which
compiles against these libraries when the code runs on Android in test
mode.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_creating_avds_for_development">Creating AVDs for Development</h5>
<div class="paragraph">
<p>Android Studio makes creating AVD (Android Virtual Devices) simple. To
start, under the "Tools" menu, click on "Android" and then select
"AVD Manager". To create a new AVD, click on the "Create Virtual
Device.." button and follow the prompts. You are generally free to
choose whatever settings you like. Google produces a real device
called the Nexus 5. This is the Android reference device, and is a
good option for a generic device with good support across all
features. You can choose this one if you are confused about which to
use.</p>
</div>
<div id="creating-new-avd" class="imageblock">
<div class="content">
<img src="images/btwg_07in03.png" alt="Creating a new AVD">
</div>
<div class="title">Figure 3. Creating a new AVD</div>
</div>
<div class="paragraph">
<p>Once you have created an AVD, start it up. It will take a few minutes
to boot; AVDs emulate the chipset in software and
booting up can take a few minutes, unfortunately. There are
alternative tools that speed up AVD boot time (Genymotion is one of
those), but there are complexities if you stray away from the stock
Android tools, so we will stick with AVD.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_default_android_main">Default Android Main</h4>
<div class="paragraph">
<p>When we use the above commands to create a new android application, it
creates a sample entry point which is the starting point of our
Android application. All Android applications have a file called
<code>AndroidManifest.xml</code> which specifies this activity and also supplies
a list of permissions to the apps. Open the <code>AndroidManifest.xml</code> file
from within the <code>app/src/main</code> directory. We need to make one change, to
add a line which specifies that this app will use the Internet
permission (required if our app will be talking to the GitHub
API). Note that when viewing this file inside Android Studio the IDE
can interpolate strings from resources, so you might see the
<code>android:label</code> attribute displayed as "GhRU" with a grey tinge, when
in fact the XML file itself has the value displayed below (<code>@string/app_name</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.example.ghru"&gt;

    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;

    &lt;application android:allowBackup="true" android:label="@string/app_name"
        android:icon="@mipmap/ic_launcher" android:supportsRtl="true"
        android:theme="@style/AppTheme"&gt;

        &lt;activity android:name="MainActivity"
            android:label="@string/app_name"&gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;
                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;

    &lt;/application&gt;

&lt;/manifest&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the application is launched, the Android OS will launch this
activity and then call the <code>onCreate</code> function for us. Inside this
function, our application calls our parent’s implementation of
<code>onCreate</code>, and then inflates the layout for our application. Layouts
are XML files in which the UI of an Android application is
declaratively described.</p>
</div>
<div class="paragraph">
<p>Android Studio created a default layout for us (called
<code>activity_main.xml</code>), but let’s ignore that and create our own
layout. To do so, right click (control-click on OSX) on the <code>layouts</code>
directory, and then choose "New" and then "Layout resource file" at
the very top of the list (Android Studio nicely chooses the most
likely candidate given the context of the click). Enter "main.xml" as
the file name, and accept the other default.s</p>
</div>
<div class="paragraph">
<p>This application requires that we login, so we know we at least need a field and a
descriptive label for the username, a password field (and associated
descriptive label) for the password, a button to click that tells our
app to attempt to login, and a status field which indicates success or
failure of the login. So, let’s modify the generated <code>main.xml</code> to
specify this user interface. To edit this file as text, click on the
tab labeled "Text" next to the tab labeled "Design" at the very bottom
of the <code>main.xml</code> pane to switch to text view. Then, edit the file to
look like the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;!-- &lt;1&gt; --&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    &gt; &lt;!-- &lt;2&gt; --&gt;
&lt;TextView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="GitHub Username:"
    /&gt;
&lt;EditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/username"
    /&gt;

&lt;TextView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="GitHub Password:"
    /&gt;

&lt;EditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/password"
    android:inputType="textWebPassword"
    /&gt; &lt;!-- &lt;3&gt; --&gt;

&lt;Button
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Login"
    android:id="@+id/login"
    /&gt; &lt;!-- &lt;4&gt; --&gt;

&lt;TextView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/login_status"
    /&gt;

&lt;/LinearLayout&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may have complicated feelings about XML files (I know I do), but
the Android layout XML files are a straightforward way to design
layouts declaratively, and there is a great ecosystem of GUI tools
that provide sophisticated ways to manage them. Scanning this XML
file, it should be relatively straightforward to understand what is
happening here.</p>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The entire layout is wrapped in a <code>LinearLayout</code> which simply
positions each element stacked vertically inside it. We set the
height and width layout attributes to <code>match_parent</code> which means this
layout occupies the entire space of the screen.</p>
</li>
<li>
<p>We then add the elements we described above: pairs of <code>TextView</code>
and <code>EditView</code> for the label and entry options necessary for the
username and password.</p>
</li>
<li>
<p>The password field customizes the type to be a password field,
which means the entry is hidden when we enter it.</p>
</li>
<li>
<p>Some elements in the XML have an ID attribute, which allows us to
access the items within our Java code, such as when we need to assign
a handler to a button or retrieve text entered by the user from an
entry field. We will demonstrate this in a moment.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can review the visual structure of this XML file by clicking in
the "Design" tab to switch back to design mode.</p>
</div>
<div class="paragraph">
<p>We also need a layout once we have logged in. Create a file called
<code>logged_in.xml</code> using the same set of steps. Once
logged in, the user is presented with a layout asking them to choose
which repository to save into, asks them to enter their blog post into
a large text field and then click a button to submit that blog
post. We also leave an empty status box beneath the button to
provide context while saving the post.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    &gt;
  &lt;TextView
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:text="Logged into GitHub"
      android:layout_weight="0"
      android:id="@+id/status" /&gt;

  &lt;EditText
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:hint="Enter the blog repository"
      android:id="@+id/repository"
      android:layout_weight="0"
      /&gt;

    &lt;EditText
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="Enter the blog title"
        android:id="@+id/title"
        android:layout_weight="0" /&gt;

    &lt;EditText
      android:gravity="top"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:hint="Enter your blog post"
      android:id="@+id/post"
      android:layout_weight="1"
      /&gt;

  &lt;Button
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:layout_weight="0"
      android:id="@+id/submit"
      android:text="Send blog post"/&gt;

&lt;/LinearLayout&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most of this should be familiar once you have reviewed the <code>main.xml</code>
file (and be sure to copy this from the associated sample repository
on GitHub if you don’t want to copy it in yourself).</p>
</div>
<div class="paragraph">
<p>Now that we have our XML established, we can ready our application for
testing.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_android_automated_testing">Android Automated Testing</h3>
<div class="paragraph">
<p>Android supports three types of tests: unit tests, integration tests,
and user interface (UI) tests. Unit tests validate very tightly
defined and isolated pieces of code, while integration tests and UI tests test
larger pieces of the whole. On Android, integration tests generally
mean instantiation of data managers or code that interacts with
multiple components inside the app, while UI testing permits testing
of user facing elements like buttons or text fields.
In this chapter we will create a unit test and UI test.</p>
</div>
<div class="paragraph">
<p>One important note: Unit tests run on your development machine, not the Android
device itself. UI tests run on the Android device (or emulator). There
can be subtle differences between the Java interpreter running on your development
machine and the Dalvik interpreter running on your Android device, so
it is worthwhile to use a mixture of the three types of tests. Stated
another way, write at least one test which runs on the device or
emulator itself!</p>
</div>
<div class="sect3">
<h4 id="_unit_tests_for_our_github_client">Unit Tests for our GitHub Client</h4>
<div class="paragraph">
<p>Let’s start by defining a unit test. Since the unit test runs on our
development machine, our test and implementation code should be
written such that they not need to load any Android classes. This
forces us to constrain functionality to only the GitHub API. We will
define a helper class which will handle all the interaction with the
GitHub API but does not know about Android whatsoever. Then, we can
write a test harness that takes that class, instantiates it and
validates our calls to GitHub produce the right results.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You might legitimately ask: is a unit test the right place to verify
an API call? Will this type of test be fast, given that slow running
unit tests are quickly ignored by software developers? Would it be
better to mock out the response data inside our unit tests? These are
all good questions!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To setup unit tests, we need to switch the build variant to unit
tests. Look for a vertical tab on the left hand side of Android
Studio. Click on this, and then where it says "Test Artifact" switch
to "Unit Tests." From the project view (click on the "Project" vertical tab if
project view is not already selected) you can expand the "java"
directory, and you should then see a directory with "(test)" in
parentheses indicating this is where tests go. If this directory is
not there, create a directory using the command line (this command
would work <code>mkdir -p app/src/test/java/com/example/ghru</code>).</p>
</div>
<div class="paragraph">
<p>Then, create a test file called <code>GitHubHelperTest.java</code> that looks like the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.example.ghru;

import com.squareup.okhttp.OkHttpClient; //  <b class="conum">(1)</b>
import com.squareup.okhttp.Request;
import com.squareup.okhttp.Response;

import org.junit.Test; //  <b class="conum">(2)</b>

import java.util.Date;

import static org.junit.Assert.assertTrue;

/**
 * To work on unit tests, switch the Test Artifact in the Build Variants view.
 */
public class GitHubHelperTest { //  <b class="conum">(3)</b>
    @Test
    public void testClient() throws Exception {

        String login = System.getenv("GITHUB_HELPER_USERNAME"); //  <b class="conum">(4)</b>
        String password = System.getenv("GITHUB_HELPER_PASSWORD");
        String repoName = login + ".github.io";

        int randomNumber = (int)(Math.random() * 10000000);
        String randomString = String.valueOf( randomNumber );
        String randomAndDate = randomString + " " + (new Date()).toString() ; //  <b class="conum">(5)</b>

        GitHubHelper ghh = new GitHubHelper( login, password ); //  <b class="conum">(6)</b>
        ghh.SaveFile(repoName,
		     "Some random title",
		     "Some random body text",
		     randomAndDate );

        Thread.sleep(3000); //  <b class="conum">(7)</b>

        String url = "https://api.github.com/repos/" +  //  <b class="conum">(8)</b>
	    login + "/" + repoName + "/events";
        OkHttpClient ok = new OkHttpClient();
        Request request = new Request.Builder()
                .url( url )
                .build();
        Response response = ok.newCall( request ).execute();
        String body = response.body().string();

        assertTrue( "Body does not have: " + randomAndDate,   //  <b class="conum">(9)</b>
		    body.contains( randomAndDate ) );
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First, we import the OkHttp library, a library for making HTTP
calls. We will verify that our GitHub API calls made it all the way into
GitHub by looking at the event log for our repository, a log
accessible via HTTP.</p>
</li>
<li>
<p>Next, we import JUnit, which provides us with an annotation
<code>@Test</code> we can use to indicate to a test runner that certain methods
are test functions (and should be executed as tests when in test mode).</p>
</li>
<li>
<p>We create a class called <code>GitHubHelperTest</code>. In it, we define a
sole test case <code>testClient</code>. We use the <code>@Test</code> annotation to indicate
to JUnit that this is a test case.</p>
</li>
<li>
<p>Now we specify our login information and the repository we want to
test against. In order to keep the password out of our source code, we
use an environment variable which we can specify when we run the
tests.</p>
</li>
<li>
<p>Next we build a random string. This unique string will be our
commit message, a beacon that allows us to verify our commit made it
all the way through and was stored on GitHub, and differentiate from
other commits made recently by other tests.</p>
</li>
<li>
<p>Now, to the meat of the test: we instantiate our GitHub helper class
with login credentials, then use the <code>SaveFile</code> function to save the
file. The last parameter is our commit message, which we will verify
later.</p>
</li>
<li>
<p>There can be times when the GitHub API has registered the commit
but the event is not yet displayed in results coming back from the
API; sleeping for a few seconds fixes this.</p>
</li>
<li>
<p>Next we go through the steps to make an HTTP call with the OkHttp
library. We load a URL which provides us with the events for a
specified repository, events which will have the commit message when
it is a push type event. This repository happens to be public so we
don’t require authentication against the GitHub API to see this data.</p>
</li>
<li>
<p>Once we have the body of the HTTP call, we can scan it to verify
the commit message is there.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The final steps deserve a bit more investigation. If we load the event
URL from cURL, we see data like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ curl https://api.github.com/repos/burningonup/burningonup.github.io/events
[
  {
    "id": "3244787408",
    "type": "PushEvent",
    ...
    "repo": {
      "id": 44361330,
      "name": "BurningOnUp/BurningOnUp.github.io",
      "url":
      "https://api.github.com/repos/BurningOnUp/BurningOnUp.github.io"
    },
    "payload": {
      ...
      "commits": [
        {
          "sha": "28f247973e73e3128737cab33e1000a7c281ff4b",
          "author": {
            "email": "unknown@example.com",
            "name": "Unknown"
          },
          "message": "207925 Thu Oct 15 23:06:09 PDT 2015",
          "distinct": true,
          "url":
	  "https://api.github.com/repos/BurningOnUp/BurningOnUp.github.io/commits/28f247973e73e3128737cab33e1000a7c281ff4b"
        }
      ]
    }
...
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is obviously JSON. We see the type is "PushEvent" for this event,
and it has a commit message which matches our random string format. We
could reconstitute this into a complex object structure, but scanning
the JSON as a string works for our test.</p>
</div>
</div>
<div class="sect3">
<h4 id="_android_ui_tests">Android UI Tests</h4>
<div class="paragraph">
<p>Let’s now write a UI test. Our test will start our app, find the
username and password fields, enter in the proper username and
password text, then click the login button, and finally verify that we
have logged in by checking for the text "Logged into GitHub" in our
UI.</p>
</div>
<div class="paragraph">
<p>Android uses the Espresso framework to support UI testing. We
already installed Espresso with our Gradle configuration, so we can
now write a test. Tests are written by deriving from a generic test
base class (<code>ActivityInstrumentationTestCase2</code>). Any public function
defined inside the test class is run as a test.</p>
</div>
<div class="paragraph">
<p>In Android Studio, from the "Build Variant" window, select "Android
Instrumentation Test" which will then display a test directory called
"androidTest". These are tests which will run on the emulator or
actual device. Inside the directory, make a new file called
<code>MainActivityTest.java</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.example.ghru;

import android.support.test.InstrumentationRegistry; // <b class="conum">(1)</b>
import android.test.ActivityInstrumentationTestCase2;
import static android.support.test.espresso.Espresso.onView;
import static android.support.test.espresso.action.ViewActions.*;
import static android.support.test.espresso.assertion.ViewAssertions.matches;
import static android.support.test.espresso.matcher.ViewMatchers.*;

public class MainActivityTest  // <b class="conum">(2)</b>
    extends ActivityInstrumentationTestCase2&lt;MainActivity&gt; {

    public MainActivityTest() {
        super( MainActivity.class ); // <b class="conum">(3)</b>
    }

    public void testLogin() { // <b class="conum">(4)</b>
        injectInstrumentation( InstrumentationRegistry.getInstrumentation() ); // <b class="conum">(5)</b>
        MainActivity mainActivity = getActivity();
        String username = mainActivity // <b class="conum">(6)</b>
                .getString( R.string.github_helper_username );
        onView( withId( R.id.username ) ) // <b class="conum">(7)</b>
	        .perform( typeText( username ) ); // <b class="conum">(8)</b>
        String password = mainActivity
                .getString( R.string.github_helper_password );
        onView( withId( R.id.password ) )
	        .perform( typeText( password ) );
        onView( withId( R.id.login ) )
	        .perform( click() );
        onView( withId( R.id.status ) ) // <b class="conum">(9)</b>
	        .check( matches( withText( "Logged into GitHub" ) ) );


    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We import the instrumentation registry (for instrumenting the
tests of our app), the base class, and matchers which will be used to
make assertions in our tests.</p>
</li>
<li>
<p>We create a test class which derives from the
<code>ActivityInstrumentationTestCase2</code> generic.</p>
</li>
<li>
<p>The constructor of an Espresso tests implementation needs to call
the parent constructor with the class of the Activity for test, in
this case <code>MainActivity</code>.</p>
</li>
<li>
<p>Our test verifies that we can login to GitHub, so we name it accordingly.</p>
</li>
<li>
<p>We then load the instrumentation registry, and also call
<code>getActivity</code>, which actually instantiates and starts the activity. In
many espresso tests these two steps will occur in a function annotated as
a <code>@Before</code> function if they are used across multiple tests (in which
case they will be run before each test). Here to simplify our function
count we can call them inside the single test function.</p>
</li>
<li>
<p>It is never a good idea to store credentials inside of a code
repository, so we retrieve the username and  password from a resource
XML file using the <code>getString</code> function available using the
activity. We will show what the contents of this secret file could
look like presently.</p>
</li>
<li>
<p>Once we have the username, we can enter it in the text field in
our UI. With the <code>onView</code> function we can interact with a view (for
example: a button or text field). <code>withId</code> finds the view using the
resource identifier inside the XML layout files. Once we have the
view, we can then perform an action (using the <code>perform</code> function)
like typing in text. This chain of calls enters the GitHub username
into the first text field.</p>
</li>
<li>
<p>We then complete our interaction with the UI, entering in the
password and then clicking the login button.</p>
</li>
<li>
<p>If all is successful, we should see the text "Logged into
GitHub". Under the hood, this test will verify that we are logged into
GitHub and display the successful result.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To provide a username and password to our test and to keep these
credentials out of our source code, create a file called <code>secrets.xml</code>
inside our <code>strings</code> directory inside the resource folder. This file
should look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;resources&gt;
    &lt;string name="github_helper_login"&gt;MyUsername&lt;/string&gt;
    &lt;string name="github_helper_password"&gt;MyPwd123&lt;/string&gt;
&lt;/resources&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure this is not checked into your source code by
adding an exception to <code>.gitignore</code> (The command <code>echo
"secrets.xml" &gt;&gt; .gitgnore</code> is a quick way to add this to your .gitignore file).</p>
</div>
<div class="paragraph">
<p>Our tests will not even compile yet because we have not yet written the
other parts of the application. As such, we will skip the setup
required to run our tests within Android Studio for now.</p>
</div>
<div class="paragraph">
<p>Let’s now build the application itself to pass these tests.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_application_implementation">Application Implementation</h3>
<div class="paragraph">
<p>Now we can start writing some Java code for our application. Let’s
make it so our <code>MainActivity</code> class will inflate the layouts we
defined earlier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.example.ghru;

import android.app.Activity;
import android.os.Bundle;
import android.widget.Button;
import android.widget.LinearLayout;
import android.widget.EditText;
import android.widget.TextView;
import android.view.View;

public class MainActivity extends Activity
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView( R.layout.main);

        Button login = (Button)findViewById( R.id.login );
        login.setOnClickListener(new View.OnClickListener() { // <b class="conum">(1)</b>
            public void onClick(View v) {
                login(); // <b class="conum">(2)</b>
            }
        });
    }

    private void login() {

        setContentView(R.layout.logged_in); // <b class="conum">(3)</b>

        Button submit = (Button)findViewById( R.id.submit );
        submit.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) { // <b class="conum">(4)</b>
                doPost(); (4)
            }
        });
    }

    private void doPost() {
        TextView tv = (TextView)findViewById( R.id.post_status ); // <b class="conum">(5)</b>
        tv.setText( "Successful jekyll post" );
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code mocks out the functionality we will be building and shows us
exactly what the UI will look like once that code is completed.</p>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We register a click handler for our login button.</p>
</li>
<li>
<p>When the login button is clicked, we call the <code>login()</code> function which triggers a login flow.</p>
</li>
<li>
<p>Once we have logged in, we inflate the logged in layout, suitable
for making a blog post.</p>
</li>
<li>
<p>We then setup another click handler for the submit button; when
clicked, we call the <code>doPost()</code> function.</p>
</li>
<li>
<p>Our <code>doPost()</code> function updates the status message at the bottom
of our application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Even though our code is not functionally complete, this application will
compile. This is a good time to play with this application and verify
the UI looks appropriate. Our login form looks like this:</p>
</div>
<div id="simple-ui-blog-posts" class="imageblock">
<div class="content">
<img src="images/btwg_07in04.png" alt="A simple UI for making blog post entries">
</div>
<div class="title">Figure 4. A simple UI for making blog post entries</div>
</div>
<div class="sect3">
<h4 id="_code_to_login_to_github">Code to Login to GitHub</h4>
<div class="paragraph">
<p>Now we can wire in the GitHub API. Let’s first work on the <code>login()</code>
function. Poking into the
<a href="https://github.com/eclipse/egit-github/tree/master/org.eclipse.egit.github.core">EGit
libary reference</a>, we can write GitHub login code that is as simple as
the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">GitHubClient client = new GitHubClient();
client.setCredentials("us3r", "passw0rd");</code></pre>
</div>
</div>
<div class="paragraph">
<p>The context in which the code runs makes as much a difference as the
code. The Android OS disallows any code from making network
connections unless it runs inside a background thread.
If you are not a Java developer already, and the thought of using
threads with Java sounds daunting, dispell your worries. The
Android SDK provides a great class for managing background tasks
called <code>AsyncTask</code>. This class provides several entry points into the
lifecycle of a thread that is managed by the Android OS. We implement
a class and then overriding two functions provided by AsyncTask: the
first function is <code>doInBackground()</code> which handles operations off the
main thread (our background thread code), and the second function is
<code>onPostExecute()</code> which runs on the UI thread and allows us to update
the UI with the results of the code that ran inside <code>doInBackground()</code>.</p>
</div>
<div class="paragraph">
<p>Before we implement the login, we need to update our <code>onCreate</code>
function of the <code>MainActivity</code>. Our login button handles logging in,
so let’s register a click handler on the login button that will call
the login task we will define inside our class based off AsyncTask.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button login = (Button)findViewById( R.id.login );
        login.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    EditText utv = (EditText)findViewById( R.id.username );
                    EditText ptv = (EditText)findViewById( R.id.password );
                    username = (String)utv.getText().toString();
                    password = (String)ptv.getText().toString(); // <b class="conum">(1)</b>
                    TextView status = (TextView)findViewById( R.id.login_status );
                    status.setText( "Logging in, please wait..." ); // <b class="conum">(2)</b>
                    new LoginTask().execute( username, password );  // <b class="conum">(3)</b>
                }
            });
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We retrieve the username and password from our UI elements.</p>
</li>
<li>
<p>Our UI should notify the user that a login is occurring in a
background task, so we grab the status text element and update the text in it.</p>
</li>
<li>
<p>We then start the background thread process to do our login. This
syntax creates a new thread for us with the username and password as
parameters. Android will manage the lifecycle of this thread for us,
including starting the new thread separate from the main UI thread.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now we can implement <code>LoginTask</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    class LoginTask extends AsyncTask&lt;String, Void, Boolean&gt; {   // <b class="conum">(1)</b>
        @Override
            protected Boolean doInBackground(String... credentials) { // <b class="conum">(2)</b>
            boolean rv = false;
            UserService us = new UserService();
            us.getClient().setCredentials( credentials[0], credentials[1] );
            try {
                User user = us.getUser( credentials[0] );  // <b class="conum">(3)</b>
                rv = null != user;
            }
            catch( IOException ioe ) {}
            return rv;
        }

        @Override
            protected void onPostExecute(Boolean result) {
            if( result ) {
                loggedIn();  // <b class="conum">(4)</b>
            }
            else { // <b class="conum">(5)</b>
                TextView status = (TextView)findViewById( R.id.login_status );
                status.setText( "Invalid login, please check credentials" );
            }
        }
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Here we define our class derived from AsyncTask. You see three
types in the generics signature: <code>String</code>, <code>Void</code>, and
<code>Boolean</code>. These are the parameters to our entry point, an
intermediate callback and the final callback which returns control to
the calling thread. The first type allows us to parameterize our
instantiated task; we need to provide a username and password to the
background task, and the first type in the signature allows us to pass
an array of Strings. You can see in the actual function definition
that the ellipsis notation provides a way to parameterize a function
with a variable number of arguments (called varargs). Inside our
defined function we expect we will send two Strings in, and we make
sure to do that in our call.</p>
</li>
<li>
<p>Once inside the <code>doInBackground()</code> function, we instantiate a
<code>UserService</code> class, a wrapper around the GitHub API which interacts
with the user service API call. In order to access this information,
we have to retrieve the client for this service call and provide the
client with the username and password credentials. This is the syntax
to do that.</p>
</li>
<li>
<p>We wrap the call to <code>getUser()</code> in a try block as the function
signature can throw an error (if the network were down, for example).
We don’t really need to retrieve information about the user using the
User object, but this call verifies that our username and password are
correct and we store the result of the call in our return value.
GitHub will not use the credentials you set until you make an API
call, so we need to use our credentials to access something in order
to verify those credentials work.</p>
</li>
<li>
<p>Let’s call our function <code>loggedIn()</code> instead of <code>login()</code> to more
accurately reflect the fact that when we call this, we are already
logged into GitHub.</p>
</li>
<li>
<p>If our login was a failure, either because of network failure, or
because our credentials were incorrect, we indicate this in the status
message. A user can retry if they wish.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>loggedIn</code> updates the UI once logging in has completed and then initiates
the post on GitHub.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    private void loggedIn() {

        setContentView(R.layout.logged_in);  // <b class="conum">(1)</b>

        Button submit = (Button)findViewById( R.id.submit );
        submit.setOnClickListener(new View.OnClickListener() { // <b class="conum">(2)</b>
            public void onClick(View v) {

                TextView status = (TextView) findViewById(R.id.login_status);
                status.setText("Logging in, please wait...");

                EditText post = (EditText) findViewById(R.id.post); // <b class="conum">(3)</b>
                String postContents = post.getText().toString();

                EditText repo = (EditText) findViewById(R.id.repository);
                String repoName = repo.getText().toString();

                EditText title = (EditText) findViewById(R.id.title);
                String titleText = title.getText().toString();

                doPost(repoName, titleText, postContents); // <b class="conum">(4)</b>
            }
        });
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Inflate the logged in layout to reflect the fact we are now logged
in.</p>
</li>
<li>
<p>Then, install a click handler on the submit button so that when we
submit our post information, we can start the process to create the
post on GitHub.</p>
</li>
<li>
<p>We need to gather up three details which the user provides: the
post body, the post title, and the repository name.</p>
</li>
<li>
<p>Using these three pieces of data, we can then call into <code>doPost</code>
and initiate the asynchronous task.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Building out <code>doPost()</code> should be more familiar now that we have
experience with AsyncTask. <code>doPost()</code> makes the commit inside of
GitHub, and it performs network activity it needs to run on a
background thread.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    private void doPost( String repoName, String title, String post ) {
        new PostTask().execute( username, password, repoName, title, post );
    }

    class PostTask extends AsyncTask&lt;String, Void, Boolean&gt; {

        @Override
        protected Boolean doInBackground(String... information) { // <b class="conum">(1)</b>
            String login = information[0];
            String password = information[1];
            String repoName = information[2];
            String titleText = information[3];
            String postContents = information[4];

            Boolean rv = false; // <b class="conum">(2)</b>
            GitHubHelper ghh = new GitHubHelper(login, password); // <b class="conum">(3)</b>
            try {
                rv = ghh.SaveFile(repoName, titleText, postContents, "GhRu Update"); // <b class="conum">(4)</b>
            } catch (IOException ioe) { // <b class="conum">(5)</b>
                Log.d(ioe.getStackTrace().toString(), "GhRu");
            }
            return rv;
        }

        @Override
        protected void onPostExecute(Boolean result) {
            TextView status = (TextView) findViewById(R.id.status);
            if (result) { // <b class="conum">(6)</b>
                status.setText("Successful jekyll post");

                EditText post = (EditText) findViewById(R.id.post);
                post.setText("");

                EditText repo = (EditText) findViewById(R.id.repository);
                repo.setText("");

                EditText title = (EditText) findViewById(R.id.title);
                title.setText("");
            } else {
                status.setText("Post failed.");
            }
        }
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First, we retrieve the parameters we need to send off to the
GitHub API. Notice that we don’t attempt to retrieve these from the
UI. Background threads don’t have access to the Android UI functions.</p>
</li>
<li>
<p>This function returns a true or false value indicating success or
failure (using the variable <code>rv</code> for "return value"). We assume that
it fails unless everything we need to do inside our function works
exactly as expected, so set the expectation to false to start. The
value of our return statement is passed to the next stage in the
lifecycle of the thread, a function called <code>onPostExecute</code> (an
optional stage in the thread lifecycle that we will use to report
status of the operation back to the user).</p>
</li>
<li>
<p>Now, we instantiate the <code>GitHubHelper</code> class. This instantiation
and usage should look very familiar as it is the same thing we did
inside our unit test.</p>
</li>
<li>
<p>Our helper class returns success or failure. If we have reached
this point, this is our final return value.</p>
</li>
<li>
<p>We will wrap the call to <code>SaveFile</code> inside a try/catch block to
make sure we handle errors; these will most likely be network errors.</p>
</li>
<li>
<p><code>onPostExecute()</code> is the function we (optionally) return to once
our background task has completed. It receives the return value from
our previous function. If we have a true value returned from
<code>doInBackground()</code> then our save file succeeded and we can update the
UI of our application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We need to import the support classes. The JARs and classes for EGit
have already been added to our project automatically using
gradle. Make sure you add these <code>import</code> statements to the top of the
file, under the other imports.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
import android.view.View;
import android.os.AsyncTask;
import org.eclipse.egit.github.core.service.UserService;
import org.eclipse.egit.github.core.User;
import java.io.IOException;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we are ready to write the code to write data into GitHub.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_to_talk_to_github">Code to talk to GitHub</h4>
<div class="paragraph">
<p>Our last step is to write the code which handles putting content into GitHub.
This is not a simple function, because the GitHub API requires you
build out the structure used internally by Git. A great reference for learning more about
this structure is the free and open source book called "Pro Git" and
specifically the last chapter called
<a href="http://git-scm.com/book/en/Git-Internals">Git Internals</a>.</p>
</div>
<div class="paragraph">
<p>In a nutshell, the GitHub
API expects you to create a git "tree" and then place a "blob" object
into that tree. You then wrap the tree in a "commit" object and then
create that commit on GitHub using a data service wrapper. In
addition, writing a tree into GitHub requires knowing the base SHA
identifier, so you’ll see code which retrieves the last SHA in the
tree associated with our current branch. This code will work
regardless of whether we are pushing code into the master branch, or
into the gh-pages branch, so this utility class works with real
Jekyll blogs.</p>
</div>
<div class="paragraph">
<p>We’ll write a helper class called <code>GitHubHelper</code> and add a single
function which writes a file to our repository.</p>
</div>
<div class="paragraph">
<p>The GitHub API requires that files stored in a repositories be
either Base64 encoded or UTF-8. The Apache Foundation provides a suite of tools
published to Maven (the same software repository where we grabbed the
EGit libraries) which can do this encoding for us, and which were
already installed in our Gradle file above (the "commons-codec" declaration).</p>
</div>
<div class="paragraph">
<p>We will start by defining a series of high level functions inside
<code>SaveFile</code> to get through building a commit inside of GitHub. Each
function itself contains some complexity so let’s look first at the
overview of what it takes to put data into GitHub using the Git Data API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.example;

import android.util.Log;

import org.eclipse.egit.github.core.*;
import org.eclipse.egit.github.core.client.GitHubClient;
import org.eclipse.egit.github.core.service.CommitService;
import org.eclipse.egit.github.core.service.DataService;
import org.eclipse.egit.github.core.service.RepositoryService;
import org.eclipse.egit.github.core.service.UserService;
import org.apache.commons.codec.binary.Base64;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.io.IOException;
import java.util.*;

class GitHubHelper {

    String login;
    String password;

    GitHubHelper( String _login, String _password ) {
        login = _login;
        password = _password;
    }

    public boolean SaveFile( String _repoName,
                             String _title,
                             String _post,
                             String _commitMessage ) throws IOException {
        post = _post;
        repoName = _repoName;
        title = _title;
        commitMessage = _commitMessage;

        boolean rv = false;

        generateContent();
        createServices();
        retrieveBaseSha();

        if( null != baseCommitSha &amp;&amp; "" != baseCommitSha ) {
            createBlob();
            generateTree();
            createCommitUser();
            createCommit();
            createResource();
            updateMasterResource();
            rv = true;
        }

        return rv;
    }

...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>SaveFile</code> function goes through each step of writing data into
a repository using the GitHub API. We will walk through each of these
functions. As you can see, the <code>SaveFile</code> function has the same
signature as the function we call inside our unit test.</p>
</div>
<div class="paragraph">
<p>Let’s implement each of the functions specified in the
GitHubHelper class.</p>
</div>
</div>
<div class="sect3">
<h4 id="_writing_the_blog_content">Writing the blog content</h4>
<div class="paragraph">
<p>First, we implement <code>generateContent()</code>. The following code snippet
shows functions defined to generate the content which we will place
into our remote git repository stored on GitHub.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    String commitMessage; // <b class="conum">(1)</b>
    String postContentsWithYfm;
    String contentsBase64;
    String filename;
    String post;
    String title;
    String repoName;

    private void generateContent() { // <b class="conum">(2)</b>
        postContentsWithYfm =  // <b class="conum">(3)</b>
	    "---\n" +
	    "layout: post\n" +
	    "published: true\n" +
	    "title: '" + title + "'\n---\n\n" +
	    post;
        contentsBase64 =  // <b class="conum">(4)</b>
	    new String( Base64.encodeBase64( postContentsWithYfm.getBytes() ) );
        filename = getFilename();
    }

    private String getFilename() {
        String titleSub = title.substring( 0,  // <b class="conum">(5)</b>
					   post.length() &gt; 30 ?
					   30 :
					   title.length() );
        String jekyllfied = titleSub.toLowerCase() // <b class="conum">(6)</b>
	    .replaceAll( "\\W+", "-")
	    .replaceAll( "\\W+$", "" );
        SimpleDateFormat sdf = new SimpleDateFormat( "yyyy-MM-dd-" ); // <b class="conum">(7)</b>
        String prefix = sdf.format( new Date() );
        return "_posts/" + prefix + jekyllfied + ".md"; // <b class="conum">(8)</b>
    }

    String blobSha;
    Blob blob;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will notice many similarities between this Java code and the
Ruby code we used in the Jekyll chapter when generating filenames
and escaping whitespace.</p>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First, we setup several instance variables we will use when
storing the data into GitHub: the commit message, the full post
including the YAML Front Matter (YFM), the post contents encoded as
Base64, the filename, and then the three parameters we saved from the
call to <code>SaveFile()</code> function: the post itself, the title and the
repository name.</p>
</li>
<li>
<p>The <code>generateContent</code> function creates the necessary components for our
new post: the full content Base64 encoded, and the filename we will
use to store the content.</p>
</li>
<li>
<p>Here we create the YAML Front Matter (see the <a href="#Jekyll">[Jekyll]</a> chapter for more
details on YFM). This YAML specifies the "post" layout and sets
publishing to "true". We need to terminate the YAML with two newlines.</p>
</li>
<li>
<p>Base64 encode the contents of the blog post
itself using a utility class found inside the Apache Commons
library. Contents inside a git repository are stored either as UTF-8
content or Base64; we could have used UTF-8 since this is text content
but Base64 works losslessly and you can always safely use Base64
without concerning yourself about the content.</p>
</li>
<li>
<p>Next, inside <code>getFilename()</code>, create the title by using the first
30 characters of the post.</p>
</li>
<li>
<p>Convert the title to lowercase, and replace whitespace with
hyphens to get the Jekyll post title format.</p>
</li>
<li>
<p>Jekyll expects the date to be formatted as <code>yyyy-MM-dd</code>, so use
the java <code>SimpleDateFormat</code> class to help in creating a string of that format.</p>
</li>
<li>
<p>Finally, create the filename from all these pieces, prepending
<code>_posts</code> to the filename, where Jekyll expects posts to reside.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now we will setup the services necessary to store a commit inside GitHub.</p>
</div>
</div>
<div class="sect3">
<h4 id="_github_services">GitHub Services</h4>
<div class="paragraph">
<p>Next, we implement <code>createServices()</code>. There are several services
(wrappers around git protocols) which we need to instantiate. We don’t
use them all immediately, but we will need them at various steps
during the file save process. The <code>createServices</code> call manages these
for us.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    RepositoryService repositoryService;
    CommitService commitService;
    DataService dataService;

    private void createServices() throws IOException {
        GitHubClient ghc = new GitHubClient();
        ghc.setCredentials( login, password );
        repositoryService = new RepositoryService( ghc );
        commitService = new CommitService( ghc );
        dataService = new DataService( ghc );
    }

...</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a side note, writing things this way would allow us to specify an
enterprise endpoint instead of GitHub.com. Refer to the entprise
appendix for specific syntax on how to do this.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_base_sha_from_the_repository_and_branch">The Base SHA from the Repository and Branch</h4>
<div class="paragraph">
<p>Now we implement <code>retrieveBaseSha()</code>. A git repository is a directed
acrylic graph (DAG) and as such, (almost) every node in the graph points
to another commit (or potentially two if it is a merge commit). When
we append content to our graph, we need to determine the prior node in
that graph and attach the new node. <code>retrieveBaseSha</code> does this: it
finds the SHA hash for our last commit, a SHA hash which is
functionally an address inside our tree. To determine this address,
our applications needs to have a reference to the repository, and we
use the repository service we instantiated earlier to get this
reference. Once we have the repository, we need to look inside the
correct branch: <code>getBranch</code> does this for us.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...

    private void createServices() throws IOException {
        GitHubClient ghc = new GitHubClient();
        ghc.setCredentials( login, password );
        repositoryService = new RepositoryService( ghc );
        commitService = new CommitService( ghc );
        dataService = new DataService( ghc );
    }

    Repository repository;
    RepositoryBranch theBranch;
    String baseCommitSha;
    private void retrieveBaseSha() throws IOException {
        // get some sha's from current state in git
        repository =  repositoryService.getRepository(login, repoName);
        theBranch = getBranch();
        baseCommitSha =  theBranch.getCommit().getSha();
    }

    public RepositoryBranch getBranch() throws IOException {
        List&lt;RepositoryBranch&gt; branches = repositoryService.getBranches(repository);
        RepositoryBranch master = null;
        // Iterate over the branches and find gh-pages or master
        for( RepositoryBranch i : branches ) {
            String theName = i.getName().toString();
            if( theName.equalsIgnoreCase("gh-pages") ) {
                theBranch = i;
            }
            else if( theName.equalsIgnoreCase("master") ) {
                master = i;
            }
        }
        if( null == theBranch ) {
            theBranch = master;
        }
        return theBranch;
    }

...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This SHA commit is very important. Without it, we cannot create a
new commit that links into our existing commit graph. In our starting
point function <code>SaveFile()</code> we discontinue our commit steps if the SHA
hash is not retrieved properly.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_the_blob">Creating the Blob</h4>
<div class="paragraph">
<p>Contents inside a git repository are stored as blobs. <code>createBlob</code>
manages storing our content as a blob object, and then uses the
dataService to store this blob into a repository. Until we have called
<code>dataService.createBlob</code>, we have not actually placed the object
inside GitHub. Also, remember that blobs are not linked into our DAG
by themselves; they need to be associated with our DAG vis-a-vis a
tree and commit object, which we do next.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    String blobSha;
    Blob blob;
    private void createBlob() throws IOException {
        blob = new Blob();
        blob.setContent(contentsBase64);
        blob.setEncoding(Blob.ENCODING_BASE64);
        blobSha = dataService.createBlob(repository, blob);
    }

...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_generating_a_tree">Generating a Tree</h4>
<div class="paragraph">
<p>Next, we generate a tree by implementing <code>generateTree()</code>. A tree
wraps a blob object and provides basically a path to our object: if
you were designing an operating system, the tree would be the filename
path and the blob is an inode. Our data service manager uses a
repository name and a base SHA address, one that we retrieved earlier,
to validate that this is a valid starting point inside our
repository. Once we have a tree, we fill out the necessary tree
attributes, like tree type (blob) and and
tree mode (blob), and set the SHA from the previously created blob
object along with the size. Then we store the tree into our GitHub
account using the data service object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    Tree baseTree;
    private void generateTree() throws IOException {
        baseTree = dataService.getTree(repository, baseCommitSha);
        TreeEntry treeEntry = new TreeEntry();
        treeEntry.setPath( filename );
        treeEntry.setMode( TreeEntry.MODE_BLOB );
        treeEntry.setType( TreeEntry.TYPE_BLOB );
        treeEntry.setSha(blobSha);
        treeEntry.setSize(blob.getContent().length());
        Collection&lt;TreeEntry&gt; entries = new ArrayList&lt;TreeEntry&gt;();
        entries.add(treeEntry);
        newTree = dataService.createTree( repository, entries, baseTree.getSha() );
    }

...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_the_commit">Creating the Commit</h4>
<div class="paragraph">
<p>We are getting close to actually finalizing the creation of content:
next, implement <code>createCommit()</code>. We have created
a blob which stores the actual content, and created a tree which
stores the path to the content (more or less), but since git is a
version control system, we also need to store information about who
wrote this object and why. A commit object stores this
information. The process should look familiar coming from the previous
steps: we create the commit and then add relevant metadata, in this case the
commit message. We also need to provide the commit user with the
commit. We then use the data service to create the commit
inside our repository in GitHub at the correct SHA address.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    CommitUser commitUser;
    private void createCommitUser() throws IOException {
        UserService us = new UserService(); // <b class="conum">(1)</b>
        us.getClient().setCredentials( login, password );
        commitUser = new CommitUser(); // <b class="conum">(2)</b>
        User user = us.getUser(); // <b class="conum">(3)</b>
        commitUser.setDate(new Date());
        String name = user.getName();
        if( null == name || name.isEmpty() ) { // <b class="conum">(4)</b>
            name = "Unknown";
        }

        commitUser.setName( name ); // <b class="conum">(5)</b>
        String email = user.getEmail();
        if( null == email || email.isEmpty() ) {
            email = "unknown@example.com";
        }
        commitUser.setEmail( email );
    }

    Commit newCommit;
    private void createCommit() throws IOException {
        // create commit
        Commit commit = new Commit(); // <b class="conum">(6)</b>
        commit.setMessage( commitMessage );
        commit.setAuthor( commitUser); // <b class="conum">(7)</b>
        commit.setCommitter( commitUser );
        commit.setTree( newTree );
        List&lt;Commit&gt; listOfCommits = new ArrayList&lt;Commit&gt;(); // <b class="conum">(8)</b>
        Commit parentCommit = new Commit();
        parentCommit.setSha(baseCommitSha);
        listOfCommits.add(parentCommit);
        commit.setParents(listOfCommits);
        newCommit = dataService.createCommit(repository, commit); // <b class="conum">(9)</b>
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Create a user service object. We will use this to get back user
data for the logged in user from GitHub.</p>
</li>
<li>
<p>We then create a commit user. This will be used to annotate the
commit object (twice in fact, as we will use it for both the author
and committer).</p>
</li>
<li>
<p>Retrieve the user from the service, loading it from GitHub.</p>
</li>
<li>
<p>Now, attempt to get the name for the logged in user. If the name
does not exist (the user has not set a name in their GitHub profile)
set the name to unknown. Then, store the name in the commit user
object.</p>
</li>
<li>
<p>Do the same process to establish the email for the commit user.</p>
</li>
<li>
<p>Now, return to the <code>createCommit</code> function and create a commit
object.</p>
</li>
<li>
<p>We need to use an author and committer, so pass in the commit user
we created in the <code>createCommitUser</code> function.</p>
</li>
<li>
<p>Next, generate a list of commits. We will only use one, but you
might recall commits can have multiple parents (a merge, for example)
and we need to specify the parent or parents for a commit. We create
the list, create a parent and set the base SHA we determined earlier,
and then indicate in our new commit that it is the parent.</p>
</li>
<li>
<p>Finally, we create the commit using our data service object.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_updating_the_master_resource">Updating the Master Resource</h4>
<div class="paragraph">
<p>Our final step is to take the new commit SHA and update your branch
reference to point to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">...
    TypedResource commitResource;
    private void createResource() {
        commitResource = new TypedResource(); // <b class="conum">(1)</b>
        commitResource.setSha(newCommit.getSha());
        commitResource.setType(TypedResource.TYPE_COMMIT);
        commitResource.setUrl(newCommit.getUrl());
    }

    private void updateMasterResource() throws IOException {
        Reference reference =
                dataService.getReference(repository,
                        "heads/" + theBranch.getName() ); // <b class="conum">(2)</b>
        reference.setObject(commitResource);
        dataService.editReference(repository, reference, true) ; // <b class="conum">(3)</b>
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First, we create the new commit resource. We then associate the
new commit SHA, indicate it is a resource of commit type, and then
link it to our commit using its URL.</p>
</li>
<li>
<p>We use the data service object to get the current branch reference
from GitHub. Branch references are retrieved by appending "heads" to
the branch (we determined the branch in a prior step).</p>
</li>
<li>
<p>Finally, we update the branch reference to our new commit resource.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This is the complete code to add data to GitHub using the Git Data
API. Good work!</p>
</div>
</div>
<div class="sect3">
<h4 id="_passing_all_our_tests">Passing all our tests</h4>
<div class="paragraph">
<p>Our code is complete. Let’s make sure our tests run successfully.</p>
</div>
<div class="paragraph">
<p>We need to setup our test configuration to run within Android Studio.
Select the "Build Variants" vertical tab on the left, and in "Test
Artifact" select "Unit Tests". Then, open the "Run" menu, and
select "Edit configurations…​". Click the plus symbol, and choose
JUnit. You will be presented with space to create a unit test run
configuration. First, click on the "Use classpath of module" and
select "app". Make sure the "Test Kind" is set to class, and then
click on the selector to the right of the "class" field. It should
display your test class "GitHubHelperTest.java". We will need to store
the username and password as environment variables, so click to add
these. Your final configuration should look like the following.</p>
</div>
<div id="creating-unit-tests" class="imageblock">
<div class="content">
<img src="images/btwg_07in05.png" alt="Creating a unit test configuration">
</div>
<div class="title">Figure 5. Creating a unit test configuration</div>
</div>
<div class="paragraph">
<p>Now, create the UI tests configuration: switch to "Android Instrumentation Tests" in the "Test Artifact"
of the "Build Variants" tab. Then, click on the "Run" menu, and again
go to "Edit configurations…​". Click on the plus symbol, and this
time choose "Android Tests". Choose "app" as the module, and then
select "android.support.test.runner.AndroidJUnitRunner" as the
specific instrumentation runner. You can choose whichever target
device you prefer, an emulator, or a physical device if you have
one. Give the configuration a name like "Android Test".</p>
</div>
<div class="paragraph">
<p>To run your tests, switch to the appropriate test artifact and then
from the "Run" menu, select "Debug…​" and choose the proper test
configuration. You can set breakpoints and step through code in your
test or implementation from within Android Studio.</p>
</div>
<div class="paragraph">
<p>I personally find it annoying to switch between build variants when I
want to run my tests, so if you prefer, you can use the command line
instead (and ignore the need to change build variants).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ GITHUB_HELPER_USERNAME=MyUsername \
GITHUB_HELPER_PASSWORD=MyPwd123 \
./gradlew testDebugUnitTest
...
:app:mockableAndroidJar UP-TO-DATE
:app:assembleDebugUnitTest UP-TO-DATE
:app:testDebugUnitTest UP-TO-DATE

BUILD SUCCESSFUL
$ ./gradlew connectedAndroidTest
...
:app:compileDebugAndroidTestNdk UP-TO-DATE
:app:compileDebugAndroidTestSources
:app:preDexDebugAndroidTest
:app:dexDebugAndroidTest
:app:packageDebugAndroidTest
:app:assembleDebugAndroidTest
:app:connectedDebugAndroidTest

BUILD SUCCESSFUL</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see similar results with the Android Studio test runner
windows. Our tests pass and our application is complete.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you want to see a more complicated version of the GitHub API on
Android, take a look at <a href="https://github.com/xrd/TeddyHyde.git">Teddy
Hyde</a> (also available on the Google Play Store). Teddy Hyde uses OAuth
to login to GitHub, and has a much richer set of features for editing
Jekyll blogs.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_summary">Summary</h3>
<div class="paragraph">
<p>This application will allow you to write into a real Jekyll blog,
adding posts, upon which GitHub will regenerate your site. This little
application manages quite a few things: formatting the filename
correctly, encoding the data for submission to GitHub, and we have a
a unit test and UI test which help to verify the functionality.</p>
</div>
<div class="paragraph">
<p>In the next chapter we will look at building a single page application
that edits information inside a GitHub repository using JavaScript and
the GitHub.js library talking to the Pull Request API.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-10-12 07:45:35 PDT
</div>

<div onclick="openCustomization()" class="fab-customization">☃</div>

<div class="loginWrapper" style="display: none">
  <div style="display: none" class="fab-user">👽</div>
  <div onclick="loginToGithub()" class="informational">Please login to GitHub</div>
</div>

<div class="informationalWrapper" style="display: none">
  <div class="informational smaller">
    Click on any dotted section to provide a comment or suggestion. Click on the edit button to cancel.
  </div>
</div>

<div onclick="toggleEditing()" class="fab">✏️</div>

<div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
      <header class="modal__header">
	<h2 class="modal__title" id="modal-1-title">
	  Add a comment or change request
	</h2>
	<button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
      </header>
      <main class="modal__content" id="modal-1-content">
	Add a comment or change to this text
	<p id="selectedText">
	</p>

	<input name="change" type="text" placeholder="Enter your comment or edit request...">
      </main>
      <footer class="modal__footer">
	<button onclick="storeIt()" class="modal__btn modal__btn-primary">Store comment</button>
	<button class="modal__btn" data-micromodal-close aria-label="Close this dialog window">Close</button>
      </footer>
    </div>
  </div>
</div>

<div class="modal micromodal-slide" id="modal-2" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-2-title">
      <header class="modal__header">
	<h2 class="modal__title" id="modal-2-title">
	  Customize this book for you.
	</h2>
	<button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
      </header>
      <main class="modal__content" id="modal-2-content">

	FYI: This does not yet work!
	<a target="_new" href="https://goo.gl/forms/8o5NgerENFqgm6vH3">Can you help provide feedback on what you like and want?</a>

	<div class="customization">
	  <input type="checkbox" name="checkbox" id="checkbox_id" value="value">
	  <label for="checkbox_id">Minimize callouts</label>
	  <div class="explanation">If a chapter contains callouts with code, don't show those.
	    You can display these individually by clicking the summary text when needed.
	  </div>
	</div>

	<div class="customization">
	  <input type="checkbox" name="checkbox" id="checkbox_id2" value="value">
	  <label for="checkbox_id2">Minimize setup instructions</label>
	  <div class="explanation">If a chapter contains setup instructions, don't show those.
	    You can display these individually by clicking the summary text when needed.
	  </div>
	</div>

	<div class="customization">
	  <input type="checkbox" name="checkbox" id="checkbox_id3" value="value">
	  <label for="checkbox_id3">Show quizes</label>
	  <div class="explanation">
	    At certain points in the discussion, present quizes which test your knowledge!
	  </div>
	</div>

	<div class="customization">
	  <input type="checkbox" name="checkbox" id="checkbox_id4" value="value">
	  <label for="checkbox_id4">Show mistakes</label>
	  <div class="explanation">
	    At times the author may have made mistakes in writing the code. You can read about the techniques
	    used to figure out something was wrong, or only see the final solution.
	  </div>
	</div>

      </main>
      <footer class="modal__footer">
	<button class="modal__btn modal__btn-primary">Save Customizations</button>
	<button class="modal__btn" data-micromodal-close aria-label="Close this dialog window">Close</button>
      </footer>
    </div>
  </div>
</div>

<div id="filedIssue">
  Thanks for your contribution!
  <div id="issueUrl"></div>.
  You've been tagged on it, so you will get updates automatically.
</div>

<iframe height="150px" width="100%" style="background-color: white !important" frameborder="0" id="th" src="https://tx.teddyhyde.com/contribution/btwg2.teddyhyde.io"></iframe>

<div class="faked">NB: This "contribution" button is a only a simulation, no actual money is required.
You can safely click the contribute button to see what would happen if you actually made a micro-contribution.
</div>

<div id="wrapper">
  <div id="personal_ad_wrapper">
    <!-- Add content to the popup -->
    <div id="personal_ad_popup">
      <h2>Thanks for your visit.</h2>

      <div>
	You aren't interesting in contributing. I get that, everyone has
	moments where it just doesn't work. Thanks for visiting.
      </div>

      <div>
	Please watch this ad for 15 seconds and
	then you'll have full access to the post.
      </div>

      <div>
	While you wait:
	<a target="_new" href="https://admin.teddyhyde.com">
	  <h3 class="underline">Why not create your own blog here?</h3>
	</a>
	Create your <strong>FREE Jekyll blog</strong> hosted on GitHub:
	<strong>fast and secure over HTTPS</strong>,
	with <strong>PWA notifications</strong> so your users never miss a post,
	and collect <strong>cryptocurrency micro-contributions</strong> with ease.
    </div>

  </div>
</div>
</div>
</div>

</body>